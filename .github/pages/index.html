<!DOCTYPE html>
<html>

<head>
	<title>ps12exe Online</title>
	<link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/steve02081504/ps12exe/master/img/icon.ico">
	<script type='text/javascript' src='https://www.midijs.net/lib/midi.js'></script>
	<script type="module">
		(async ({ chrome, netscape }) => {
			if (!chrome && !netscape) await import('https://unpkg.com/@ungap/custom-elements')
			const { default: HighlightedCode } = await import('https://unpkg.com/highlighted-code')
			HighlightedCode.useTheme('github-dark')
		})(self)
	</script>
</head>

<body>
	<textarea style="width: 98%; height:95vh;" is="highlighted-code" language="powershell" tabSize="4" placeholder="#_pragma noConsole
'Hello World!'
" id="inputText"></textarea>
	<br>
	<button id="compileButton" onclick="compileCode()">cum out</button>
	<script type="text/javascript">
		const translations = {
			'zh': { compileButtonText: '编译', compileMessage: '已将编译用的Powershell代码复制到剪切板！\n现在你只需要在Powershell里粘贴并运行代码就可以得到编译结果了！' },
			'zh-CN': { compileButtonText: '编译', compileMessage: '已将编译用的Powershell代码复制到剪切板！\n现在你只需要在Powershell里粘贴并运行代码就可以得到编译结果了！' },
			'zh-TW': { compileButtonText: '編譯', compileMessage: '已將編譯用的Powershell代碼複製到剪貼簿！\n現在你只需要在Powershell裡粘貼並執行代碼就可以得到編譯結果了！' },
			'zh-HK': { compileButtonText: '編譯', compileMessage: '已將編譯用的Powershell代碼複製到剪貼簿！\n現在你只需要在Powershell裡粘貼並執行代碼就可以得到編譯結果了！' },
			'es': { compileButtonText: 'compilar', compileMessage: 'Se ha copiado el código de Powershell para compilar en el portapapeles. Ahora solo necesitas pegarlo y ejecutarlo en Powershell para obtener el resultado de la compilación.' },
			'es-ES': { compileButtonText: 'compilar', compileMessage: 'Se ha copiado el código de Powershell para compilar en el portapapeles. Ahora solo necesitas pegarlo y ejecutarlo en Powershell para obtener el resultado de la compilación.' },
			'ja': { compileButtonText: 'コンパイル', compileMessage: 'Powershellのコンパイル用コードがクリップボードにコピーされました！\nこれをPowershellに貼り付けて実行するだけで、コンパイル結果が得られます！' },
			'ja-JP': { compileButtonText: 'コンパイル', compileMessage: 'Powershellのコンパイル用コードがクリップボードにコピーされました！\nこれをPowershellに貼り付けて実行するだけで、コンパイル結果が得られます！' },
			'ko': { compileButtonText: '컴파일', compileMessage: 'Powershell 코드를 컴파일하기 위한 내용이 클립보드에 복사되었습니다! 이제 Powershell에서 해당 코드를 붙여넣고 실행하면 컴파일 결과를 얻을 수 있습니다!' },
			'ko-KR': { compileButtonText: '컴파일', compileMessage: 'Powershell 코드를 컴파일하기 위한 내용이 클립보드에 복사되었습니다! 이제 Powershell에서 해당 코드를 붙여넣고 실행하면 컴파일 결과를 얻을 수 있습니다!' },
			'ru': { compileButtonText: 'компилировать', compileMessage: 'Код для компиляции на Powershell был скопирован в буфер обмена! Теперь вам нужно просто вставить его в Powershell и выполнить, чтобы получить результат компиляции!' },
			'ru-RU': { compileButtonText: 'компилировать', compileMessage: 'Код для компиляции на Powershell был скопирован в буфер обмена! Теперь вам нужно просто вставить его в Powershell и выполнить, чтобы получить результат компиляции!' },
			'en': { compileButtonText: 'compile', compileMessage: 'The Powershell code for compilation has been copied to the clipboard! Now you just need to paste and run the code in Powershell to get the compilation result!' },
			'en-UK': { compileButtonText: 'compile', compileMessage: 'The Powershell code for compilation has been copied to the clipboard! Now you just need to paste and run the code in Powershell to get the compilation result!' },
			'pt': { compileButtonText: 'compilar', compileMessage: 'O código Powershell para compilação foi copiado para a área de transferência! Agora você só precisa colar e executar o código no Powershell para obter o resultado da compilação!' },
			'pt-PT': { compileButtonText: 'compilar', compileMessage: 'O código Powershell para compilação foi copiado para a área de transferência! Agora você só precisa colar e executar o código no Powershell para obter o resultado da compilação!' }
		}

		const language = navigator.language || navigator.userLanguage || 'en'
		const { compileButtonText, compileMessage } = translations[language]

		const compileButton = document.getElementById('compileButton')
		const inputText = document.getElementById('inputText')
		var playing = false
		inputText.addEventListener("focus", event => {
			if (playing) MIDIjs.resume()
			else MIDIjs.play('https://raw.githubusercontent.com/steve02081504/ps12exe/master/src/bin/Unravel.mid',true)
			playing = true;
		})
		inputText.addEventListener("blur", event => MIDIjs.pause())

		compileButton.textContent = compileButtonText
		function compileCode() {
			var code = inputText.value
			var compileCodebase = code.replace("\'", "''")
			var compileCode = "if (-not (Get-Module -ListAvailable ps12exe)) { Install-Module ps12exe -Force -Scope CurrentUser };" +
			"'"+compileCodebase+"' | ps12exe"
			navigator.clipboard.writeText(compileCode)
			alert(compileMessage)
		}
	</script>
</body>

</html>
